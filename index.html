<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agendamento M√©dico</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link rel="stylesheet" href="styles.css">
    <script src="script.js" defer></script>
</head>
<body data-theme="light">
    <div class="header">
        <img src="img/sesibranco.png" alt="SESI Logo" class="header-logo" id="sesiLogo">
        <div class="logo">
            <span>ü©∫</span>
            Agendamento Pessoa F√≠sica - SESI Sa√∫de
        </div>
        <button class="theme-toggle" onclick="toggleTheme()" aria-label="Alternar tema" role="switch" aria-checked="false">üåô</button>
        <img src="img/melhoriatodobranco.png" alt="Melhoria Logo" class="header-logo" id="melhoriaLogo">
    </div>
    <div class="container">
        <div class="section">
            <h3>üë§ Dados da Consulta</h3>
            <label for="patientName">Nome do Paciente <span aria-hidden="true" class="required">*</span> <span class="help-tooltip">?<span class="tooltip-text">Digite o nome completo do paciente para facilitar a identifica√ß√£o.</span></span></label>
            <input type="text" id="patientName" placeholder="Digite o nome completo do paciente" aria-required="true" aria-describedby="patientNameDesc" required>
            <small id="patientNameDesc" class="sr-only">Campo obrigat√≥rio. Digite o nome completo do paciente.</small>
            <label for="patientCpf">CPF do Paciente <span class="help-tooltip">?<span class="tooltip-text">Formato: 123.456.789-00. Valida√ß√£o autom√°tica.</span></span></label>
            <input type="text" id="patientCpf" placeholder="Digite o CPF (ex: 123.456.789-00)" aria-describedby="cpfError patientCpfDesc">
            <small id="cpfError" class="error-message" aria-live="polite">CPF inv√°lido. (Apenas N√∫meros).</small>
            <small id="patientCpfDesc" class="sr-only">Campo opcional. Digite o CPF no formato 123.456.789-00.</small>
            <label for="patientPhone">N√∫mero do Telefone <span aria-hidden="true" class="required">*</span> <span class="help-tooltip">?<span class="tooltip-text">Formato: (11) 99999-9999. Valida√ß√£o autom√°tica.</span></span></label>
            <input type="tel" id="patientPhone" placeholder="Digite o n√∫mero do telefone (ex: (11) 99999-9999)" aria-required="true" aria-describedby="phoneError patientPhoneDesc" required>
            <small id="phoneError" class="error-message" aria-live="polite">Telefone inv√°lido. Use o formato (DD) 9XXXX-XXXX.</small>
            <small id="patientPhoneDesc" class="sr-only">Campo obrigat√≥rio. Digite o telefone no formato (11) 99999-9999.</small>
            <label for="schedulerName">Respons√°vel pelo Agendamento <span class="help-tooltip">?<span class="tooltip-text">Opcional: Nome de quem est√° agendando.</span></span></label>
            <input type="text" id="schedulerName" placeholder="Digite o nome do respons√°vel pelo agendamento" aria-describedby="schedulerNameDesc">
            <small id="schedulerNameDesc" class="sr-only">Campo opcional para o nome do respons√°vel pelo agendamento.</small>
            <label for="locationSelect">üè¢ Local do Atendimento <span aria-hidden="true" class="required">*</span></label>
            <select id="locationSelect" aria-required="true" aria-describedby="locationDesc" required>
                <option value="">Selecione um local</option>
            </select>
            <small id="locationDesc" class="sr-only">Campo obrigat√≥rio. Escolha o local de atendimento.</small>
            <label for="prioritySelect">Atendimento Priorit√°rio <span aria-hidden="true" class="required">*</span> <span class="help-tooltip">?<span class="tooltip-text">Indique se o paciente precisa de atendimento urgente.</span></span></label>
            <select id="prioritySelect" aria-required="true" aria-describedby="priorityDesc" required>
                <option value="">Selecione</option>
                <option value="Sim">Sim</option>
                <option value="N√£o">N√£o</option>
            </select>
            <small id="priorityDesc" class="sr-only">Indique se o atendimento √© priorit√°rio.</small>
            <label for="firstAppointmentSelect">Primeiro Atendimento <span aria-hidden="true" class="required">*</span> <span class="help-tooltip">?<span class="tooltip-text">Marque se √© a primeira consulta do paciente.</span></span></label>
            <select id="firstAppointmentSelect" aria-required="true" aria-describedby="firstAppointmentDesc" required>
                <option value="">Selecione</option>
                <option value="Sim">Sim</option>
                <option value="N√£o">N√£o</option>
            </select>
            <small id="firstAppointmentDesc" class="sr-only">Indique se √© o primeiro atendimento.</small>
            <label for="observations">Observa√ß√µes <span class="help-tooltip">?<span class="tooltip-text">Adicione detalhes importantes sobre o paciente ou consulta.</span></span></label>
            <textarea id="observations" placeholder="Digite observa√ß√µes adicionais (opcional)" aria-describedby="observationsDesc"></textarea>
            <small id="observationsDesc" class="sr-only">Campo opcional para observa√ß√µes adicionais.</small>
            <div id="displayedDiscounts" style="display:none;">
                <h4>Descontos Aplicados:</h4>
                <p id="industryDiscountDisplay"></p>
                <p id="promotionalDiscountDisplay"></p>
                <button class="close-discount-btn" onclick="closeDiscountDisplay()">Fechar</button>
            </div>
        </div>
        <div class="section">
            <h3>Especialidades Dispon√≠veis</h3>
            <div class="agenda-type-select">
                <h4>üìã Selecione o Tipo de Agenda</h4>
                <label for="agendaTypeSelect" class="sr-only">Tipo de agenda</label>
                <select id="agendaTypeSelect" aria-required="true" aria-describedby="agendaTypeDesc">
                    <option value="">Selecione</option>
                </select>
                <small id="agendaTypeDesc" class="sr-only">Escolha o tipo de agenda para exibir profissionais e hor√°rios dispon√≠veis.</small>
            </div>
            <div class="dentist-select">
                <h4>üë§ Selecione o Profissional</h4>
                <label for="dentistSelect" class="sr-only">Profissional</label>
                <select id="dentistSelect" aria-required="true" aria-describedby="dentistDesc">
                    <option value="">Selecione um profissional</option>
                </select>
                <small id="dentistDesc" class="sr-only">Selecione o profissional para verificar hor√°rios dispon√≠veis.</small>
            </div>
            <div class="button-row" id="sectionButtons" style="display: flex;">
                <button class="block-btn" id="blockDateBtn" onclick="blockSelectedDate()" disabled aria-label="Bloquear data selecionada" role="button">üîí Bloquear Data</button>
                <button class="agenda-mgmt-toggle" onclick="toggleAgendaMgmt()" aria-label="Gerenciar agenda" role="button">üìã Gest√£o de Agenda</button>
                <button class="block-btn" id="blockProfessionalBtn" onclick="blockSelectedProfessional()" aria-label="Bloquear profissional" role="button">üîí Bloquear Profissional</button>
            </div>
            <div class="calendar-header">
                <div class="month-nav">
                    <button onclick="prevMonth()" aria-label="M√™s anterior" role="button">‚Äπ</button>
                    <span class="month" id="monthDisplay" role="status">outubro 2025</span>
                    <button onclick="nextMonth()" aria-label="Pr√≥ximo m√™s" role="button">‚Ä∫</button>
                </div>
            </div>
            <div class="calendar" id="calendar" role="grid" aria-label="Calend√°rio">
                <!-- Calendar will be generated by JS -->
            </div>
            <div class="selected-date" id="selectedDate" style="display: none;" role="alert">
                Data selecionada: <span id="selectedDateText"></span>
            </div>
        </div>
        <div class="section">
            <h3>Selecione um Hor√°rio</h3>
            <div class="hours-grid" id="hoursGrid" role="grid" aria-label="Hor√°rios dispon√≠veis">
                <!-- Hours will be populated by JS -->
            </div>
            <button class="add-discount-btn" onclick="openDiscountModal()" aria-label="Adicionar Desconto">Adicionar Desconto</button>
            <button class="schedule-btn" id="scheduleBtn" onclick="saveAppointment()" disabled aria-label="Agendar consulta (desabilitado at√© preencher todos os campos obrigat√≥rios)" role="button">
                Agendar Consulta
                <div class="spinner" id="scheduleSpinner"></div>
            </button>
        </div>
    </div>
    <div class="agenda-mgmt-section" id="agendaMgmtSection" style="display: none;">
        <h3>üìã Gest√£o de Agendas</h3>
        <button class="toggle-scheduled-btn" onclick="toggleAgendaMgmt()" aria-label="Fechar gest√£o de agenda" role="button">Fechar</button>
        <div class="agenda-mgmt-grid" id="agendaMgmtGrid">
            <!-- Populated by JS -->
        </div>
    </div>
    <div class="scheduled-section">
        <h3>üìã Consultas Agendadas</h3>
        <button class="toggle-scheduled-btn" id="toggleScheduledBtn" onclick="toggleScheduled()" aria-label="Mostrar ou ocultar lista de consultas agendadas" role="button">Mostrar Consultas Agendadas</button>
        <div class="scheduled-grid" id="scheduledGrid">
            <div class="scheduled-column odontologia">
                <h4>ü¶∑ Odontol√≥gica</h4>
                <div class="date-filters">
                    <label for="odontologiaStartDate">Data Inicial:</label>
                    <input type="date" id="odontologiaStartDate" onchange="debouncedFilterAppointments()" aria-label="Data inicial odontol√≥gica">
                    <label for="odontologiaEndDate">Data Final:</label>
                    <input type="date" id="odontologiaEndDate" onchange="debouncedFilterAppointments()" aria-label="Data final odontol√≥gica">
                </div>
                <div class="professional-filter">
                    <label for="odontologiaProfessional">Profissional:</label>
                    <select id="odontologiaProfessional" onchange="debouncedFilterAppointments()" aria-label="Profissional odontol√≥gico">
                        <option value="">Todos</option>
                    </select>
                </div>
                <div class="cpf-filter">
                    <label for="odontologiaCpf">CPF:</label>
                    <input type="text" id="odontologiaCpf" placeholder="Digite o CPF (ex: 123.456.789-00)" oninput="formatFilterCPF(this); debouncedFilterAppointments()" maxlength="14" aria-label="Filtro por CPF odontol√≥gico">
                </div>
                <div class="search-filter">
                    <label for="odontologiaSearch">Buscar Paciente:</label>
                    <input type="text" id="odontologiaSearch" placeholder="Digite nome do paciente" oninput="debouncedFilterAppointments()" aria-label="Busca por paciente odontol√≥gico">
                </div>
                <button class="clear-filters-btn" onclick="clearOdontologiaFilters()">Limpar Filtros</button>
                <div id="odontologiaList" class="scheduled-list" role="list" aria-label="Lista de agendamentos odontol√≥gicos">
                    <p class="empty-message">Nenhum agendamento odontol√≥gico.</p>
                </div>
            </div>
            <div class="scheduled-column">
                <h4>üè• Especialidades M√©dicas</h4>
                <div class="date-filters">
                    <label for="medicasStartDate">Data Inicial:</label>
                    <input type="date" id="medicasStartDate" onchange="debouncedFilterAppointments()" aria-label="Data inicial m√©dica">
                    <label for="medicasEndDate">Data Final:</label>
                    <input type="date" id="medicasEndDate" onchange="debouncedFilterAppointments()" aria-label="Data final m√©dica">
                </div>
                <div class="professional-filter">
                    <label for="medicasProfessional">Profissional:</label>
                    <select id="medicasProfessional" onchange="debouncedFilterAppointments()" aria-label="Profissional m√©dico">
                        <option value="">Todos</option>
                    </select>
                </div>
                <div class="cpf-filter">
                    <label for="medicasCpf">CPF:</label>
                    <input type="text" id="medicasCpf" placeholder="Digite o CPF (ex: 123.456.789-00)" oninput="formatFilterCPF(this); debouncedFilterAppointments()" maxlength="14" aria-label="Filtro por CPF m√©dico">
                </div>
                <div class="search-filter">
                    <label for="medicasSearch">Buscar Paciente:</label>
                    <input type="text" id="medicasSearch" placeholder="Digite nome do paciente" oninput="debouncedFilterAppointments()" aria-label="Busca por paciente m√©dico">
                </div>
                <button class="clear-filters-btn" onclick="clearMedicasFilters()">Limpar Filtros</button>
                <div id="medicasList" class="scheduled-list" role="list" aria-label="Lista de agendamentos m√©dicos">
                    <p class="empty-message">Nenhum agendamento de especialidades m√©dicas.</p>
                </div>
            </div>
            <div class="scheduled-column exames">
                <h4>üî¨ Exames</h4>
                <div class="date-filters">
                    <label for="examesStartDate">Data Inicial:</label>
                    <input type="date" id="examesStartDate" onchange="debouncedFilterAppointments()" aria-label="Data inicial exames">
                    <label for="examesEndDate">Data Final:</label>
                    <input type="date" id="examesEndDate" onchange="debouncedFilterAppointments()" aria-label="Data final exames">
                </div>
                <div class="professional-filter">
                    <label for="examesProfessional">Profissional:</label>
                    <select id="examesProfessional" onchange="debouncedFilterAppointments()" aria-label="Profissional exames">
                        <option value="">Todos</option>
                    </select>
                </div>
                <div class="cpf-filter">
                    <label for="examesCpf">CPF:</label>
                    <input type="text" id="examesCpf" placeholder="Digite o CPF (ex: 123.456.789-00)" oninput="formatFilterCPF(this); debouncedFilterAppointments()" maxlength="14" aria-label="Filtro por CPF exames">
                </div>
                <div class="search-filter">
                    <label for="examesSearch">Buscar Paciente:</label>
                    <input type="text" id="examesSearch" placeholder="Digite nome do paciente" oninput="debouncedFilterAppointments()" aria-label="Busca por paciente exames">
                </div>
                <button class="clear-filters-btn" onclick="clearExamesFilters()">Limpar Filtros</button>
                <div id="examesList" class="scheduled-list" role="list" aria-label="Lista de agendamentos de exames">
                    <p class="empty-message">Nenhum agendamento de exames.</p>
                </div>
            </div>
        </div>
    </div>
    <div class="scheduled-section" id="blockedSection">
        <h3>üîí Gerenciar Datas Bloqueadas</h3>
        <button class="toggle-scheduled-btn" id="toggleBlockedBtn" onclick="toggleBlocked()" aria-label="Mostrar ou ocultar lista de datas bloqueadas" role="button">Mostrar Datas Bloqueadas</button>
        <div class="scheduled-grid" id="blockedGrid" style="display: none;">
            <div class="scheduled-column">
                <h4>Bloqueios Ativos</h4>
                <div id="blockedSummary" class="blocked-summary" style="display: none;"></div>
                <div id="blockedList" class="scheduled-list" role="list" aria-label="Lista de datas bloqueadas">
                    <p class="empty-message">Nenhuma data bloqueada.</p>
                </div>
            </div>
        </div>
    </div>
    <div class="scheduled-section">
        <h3>üìä Relat√≥rios de Agendamentos</h3>
        <button class="toggle-scheduled-btn" id="toggleReportBtn" onclick="toggleReport()" aria-label="Mostrar ou ocultar se√ß√£o de relat√≥rios" role="button">Mostrar Relat√≥rios</button>
        <div class="report-section" id="reportContent" style="display: none;">
            <div class="report-filters">
                <label for="reportAgendaType" class="sr-only">Tipo de relat√≥rio</label>
                <select id="reportAgendaType" aria-label="Tipo de relat√≥rio">
                    <option value="">Todos os Tipos</option>
                    <option value="Agenda Odontol√≥gica">Agenda Odontol√≥gica</option>
                    <option value="Agenda Especialidades M√©dicas">Agenda Especialidades M√©dicas</option>
                    <option value="Agenda de Exames">Agenda de Exames</option>
                </select>
                <label for="reportStartDate" class="sr-only">Data inicial relat√≥rio</label>
                <input type="date" id="reportStartDate" aria-label="Data inicial relat√≥rio">
                <label for="reportEndDate" class="sr-only">Data final relat√≥rio</label>
                <input type="date" id="reportEndDate" aria-label="Data final relat√≥rio">
                <button class="report-btn" onclick="generateReport()" aria-label="Gerar relat√≥rio de agendamentos" role="button">
                    Gerar Relat√≥rio
                    <div class="spinner" id="reportSpinner"></div>
                </button>
                <button class="export-btn" id="exportBtn" onclick="exportToExcel()" style="display: none;" aria-label="Exportar relat√≥rio para Excel" role="button">Exportar Excel</button>
            </div>
            <div id="reportTableContainer" style="display: none;">
                <table class="report-table" id="reportTable" role="table" aria-label="Tabela de relat√≥rios">
                    <thead>
                        <tr>
                            <th>Paciente</th>
                            <th>CPF</th>
                            <th>Telefone</th>
                            <th>Data</th>
                            <th>Hor√°rio</th>
                            <th>Profissional</th>
                            <th>Tipo</th>
                            <th>Local</th>
                            <th>Priorit√°rio</th>
                            <th>Primeiro Atendimento</th>
                            <th>Status</th>
                            <th>Observa√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="reportTableBody" role="rowgroup"></tbody>
                </table>
                <div class="summary" id="summaryStats"></div>
                <div class="charts-container">
                    <div class="chart-wrapper">
                        <h4>Distribui√ß√£o por Tipo</h4>
                        <div class="chart-container">
                            <canvas id="reportChart" aria-label="Gr√°fico de colunas mostrando distribui√ß√£o de agendamentos por tipo" role="img"></canvas>
                        </div>
                        <div class="chart-percentages" id="barPercentages"></div>
                    </div>
                    <div class="chart-wrapper">
                        <h4>Taxa de Comparecimento Detalhada</h4>
                        <div class="chart-container">
                            <canvas id="attendanceChart" aria-label="Gr√°fico de colunas mostrando taxa de comparecimento detalhada" role="img"></canvas>
                        </div>
                        <div class="chart-percentages" id="barAttendancePercentages"></div>
                    </div>
                    <div class="chart-wrapper">
                        <h4>Produtividade por Profissional</h4>
                        <div class="chart-container">
                            <canvas id="productivityChart" aria-label="Gr√°fico de colunas mostrando produtividade por profissional" role="img"></canvas>
                        </div>
                        <div class="chart-percentages" id="productivityPercentages"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="scheduled-section">
        <h3>üí∞ Consulta Pre√ßo de Exames</h3>
        <button class="exam-price-btn" onclick="window.open('https://consultapreco.pe.sesi.org.br/', '_blank')" aria-label="Abrir consulta de pre√ßo de exames" role="button">Consulta Pre√ßo de Exames</button>
    </div>
    <!-- Toast Notification -->
    <div id="toast" class="toast" role="alert" aria-live="polite">Consulta agendada com sucesso!</div>
    <!-- Block Modal -->
    <div id="blockModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="blockTitle">
        <div class="modal-content">
            <span class="close" onclick="closeModal('blockModal')" aria-label="Fechar modal de bloqueio de data">&times;</span>
            <h3 id="blockTitle">Bloquear Data</h3>
            <p>Data: <span id="blockDateText"></span></p>
            <label for="blockAgendaType">Tipo de Agenda <span aria-hidden="true" class="required">*</span></label>
            <select id="blockAgendaType" aria-required="true" required>
                <option value="">Selecione o tipo de agenda</option>
            </select>
            <label for="blockReason">Motivo do Bloqueio <span aria-hidden="true" class="required">*</span></label>
            <textarea id="blockReason" placeholder="Digite o motivo do bloqueio..." aria-required="true" required></textarea>
            <button class="modal-btn" onclick="confirmBlock()" aria-label="Confirmar bloqueio da data" role="button">Bloquear Data</button>
            <button class="modal-btn cancel-btn" onclick="closeModal('blockModal')" aria-label="Cancelar bloqueio da data" role="button">Cancelar</button>
        </div>
    </div>
    <!-- Block Professional Modal -->
    <div id="blockProfessionalModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="blockProfessionalTitle">
        <div class="modal-content">
            <span class="close" onclick="closeModal('blockProfessionalModal')" aria-label="Fechar modal de bloqueio de profissional">&times;</span>
            <h3 id="blockProfessionalTitle">Bloquear Profissional</h3>
            <label for="blockProfessionalAgendaType">Tipo de Agenda <span aria-hidden="true" class="required">*</span></label>
            <select id="blockProfessionalAgendaType" onchange="populateBlockProfessionalSelect()" aria-required="true" required>
                <option value="">Selecione o tipo de agenda</option>
            </select>
            <label for="blockProfessionalSelect">Profissional <span aria-hidden="true" class="required">*</span></label>
            <select id="blockProfessionalSelect" aria-required="true" required>
                <option value="">Selecione o profissional</option>
            </select>
            <label for="blockProfessionalStartDate">Data de In√≠cio do Bloqueio <span aria-hidden="true" class="required">*</span></label>
            <input type="date" id="blockProfessionalStartDate" aria-required="true" required>
            <label for="blockProfessionalEndDate">Data de Fim do Bloqueio <span aria-hidden="true" class="required">*</span></label>
            <input type="date" id="blockProfessionalEndDate" aria-required="true" required>
            <label for="blockProfessionalReason">Motivo do Bloqueio <span aria-hidden="true" class="required">*</span></label>
            <textarea id="blockProfessionalReason" placeholder="Digite o motivo do bloqueio..." aria-required="true" required></textarea>
            <button class="modal-btn" onclick="confirmBlockProfessional()" aria-label="Confirmar bloqueio do profissional" role="button">Bloquear Profissional</button>
            <button class="modal-btn cancel-btn" onclick="closeModal('blockProfessionalModal')" aria-label="Cancelar bloqueio do profissional" role="button">Cancelar</button>
        </div>
    </div>
    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="deleteTitle">
        <div class="modal-content">
            <span class="close" onclick="closeModal('deleteModal')" aria-label="Fechar modal de confirma√ß√£o de exclus√£o">&times;</span>
            <h3 id="deleteTitle">Confirmar Inativa√ß√£o</h3>
            <p id="confirmDescription">Tem certeza que deseja inativar esta consulta? Esta a√ß√£o n√£o pode ser desfeita.</p>
            <button class="modal-btn confirm-delete" onclick="proceedToReason()" aria-label="Confirmar inativa√ß√£o da consulta" role="button">Sim, Confirmar</button>
            <button class="modal-btn cancel-btn" onclick="closeModal('deleteModal')" aria-label="Cancelar inativa√ß√£o da consulta" role="button">Cancelar</button>
        </div>
    </div>
    <!-- Edit Modal -->
    <div id="editModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="editTitle">
        <div class="modal-content">
            <span class="close" onclick="closeModal('editModal')" aria-label="Fechar modal de edi√ß√£o de consulta">&times;</span>
            <h3 id="editTitle">Editar Consulta</h3>
            <label for="editPatientName">Nome do Paciente <span aria-hidden="true" class="required">*</span></label>
            <input type="text" id="editPatientName" aria-required="true" required autofocus>
            <label for="editPatientCpf">CPF do Paciente</label>
            <input type="text" id="editPatientCpf" aria-describedby="editCpfError editPatientCpfDesc">
            <small id="editCpfError" class="error-message" aria-live="polite">CPF inv√°lido. Verifique os d√≠gitos.</small>
            <small id="editPatientCpfDesc" class="sr-only">Digite o CPF no formato 123.456.789-00.</small>
            <label for="editPatientPhone">N√∫mero do Telefone <span aria-hidden="true" class="required">*</span></label>
            <input type="tel" id="editPatientPhone" aria-required="true" aria-describedby="editPhoneError editPatientPhoneDesc" required>
            <small id="editPhoneError" class="error-message" aria-live="polite">Telefone inv√°lido. Use o formato (DD) 9XXXX-XXXX.</small>
            <small id="editPatientPhoneDesc" class="sr-only">Digite o telefone no formato (11) 99999-9999.</small>
            <label for="editSchedulerName">Nome do Respons√°vel pelo Agendamento</label>
            <input type="text" id="editSchedulerName" placeholder="Digite o nome do respons√°vel pelo agendamento">
            <label for="editLocationSelect">Local do Atendimento <span aria-hidden="true" class="required">*</span></label>
            <select id="editLocationSelect" aria-required="true" required></select>
            <label for="editAgendaTypeSelect">Tipo de Agenda <span aria-hidden="true" class="required">*</span></label>
            <select id="editAgendaTypeSelect" onchange="populateEditProfessionals()" aria-required="true" required></select>
            <label for="editDentistSelect">Profissional <span aria-hidden="true" class="required">*</span></label>
            <select id="editDentistSelect" onchange="populateEditTimes()" aria-required="true" required></select>
            <label for="editDate">Data da Consulta <span aria-hidden="true" class="required">*</span></label>
            <input type="date" id="editDate" required aria-required="true">
            <label for="editTime">Hor√°rio da Consulta <span aria-hidden="true" class="required">*</span></label>
            <select id="editTime" required aria-required="true"></select>
            <label for="editPrioritySelect">Atendimento Priorit√°rio <span aria-hidden="true" class="required">*</span></label>
            <select id="editPrioritySelect" aria-required="true" required>
                <option value="">Selecione</option>
                <option value="Sim">Sim</option>
                <option value="N√£o">N√£o</option>
            </select>
            <label for="editFirstAppointmentSelect">Primeiro Atendimento <span aria-hidden="true" class="required">*</span></label>
            <select id="editFirstAppointmentSelect" aria-required="true" required>
                <option value="">Selecione</option>
                <option value="Sim">Sim</option>
                <option value="N√£o">N√£o</option>
            </select>
            <label for="editObservations">Observa√ß√µes</label>
            <textarea id="editObservations" placeholder="Digite observa√ß√µes adicionais (opcional)"></textarea>
            <button class="modal-btn" onclick="saveEdit()" aria-label="Salvar altera√ß√µes na consulta" role="button">Salvar Altera√ß√µes</button>
            <button class="modal-btn cancel-btn" onclick="closeModal('editModal')" aria-label="Cancelar edi√ß√£o da consulta" role="button">Cancelar</button>
        </div>
    </div>
    <!-- Print Confirmation Modal -->
    <div id="printConfirmModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="printConfirmTitle">
        <div class="modal-content">
            <span class="close" onclick="closeModal('printConfirmModal')" aria-label="Fechar modal de confirma√ß√£o de impress√£o">&times;</span>
            <h3 id="printConfirmTitle">Imprimir Comprovante</h3>
            <p>Deseja imprimir o comprovante de agendamento?</p>
            <button class="modal-btn" onclick="showPrintTypeModal()" aria-label="Sim, imprimir" role="button">Sim</button>
            <button class="modal-btn cancel-btn" onclick="closeModal('printConfirmModal')" aria-label="N√£o imprimir" role="button">N√£o</button>
        </div>
    </div>
    <!-- Print Type Modal -->
    <div id="printTypeModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="printTypeTitle">
        <div class="modal-content">
            <span class="close" onclick="closeModal('printTypeModal')" aria-label="Fechar modal de tipo de impress√£o">&times;</span>
            <h3 id="printTypeTitle">Tipo de Impress√£o</h3>
            <div class="radio-group">
                <label><input type="radio" name="printType" value="normal" checked> Impressora Padr√£o</label>
                <label><input type="radio" name="printType" value="thermal"> Impressora T√©rmica</label>
            </div>
            <button class="modal-btn" onclick="generatePrintPDF()" aria-label="Gerar PDF" role="button">Gerar PDF</button>
            <button class="modal-btn cancel-btn" onclick="closeModal('printTypeModal')" aria-label="Cancelar impress√£o" role="button">Cancelar</button>
        </div>
    </div>
    <!-- Patient History Modal -->
    <div id="patientHistoryModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="historyTitle">
        <div class="modal-content">
            <span class="close" onclick="closeModal('patientHistoryModal')" aria-label="Fechar hist√≥rico do paciente">&times;</span>
            <h3 id="historyTitle">Hist√≥rico de Atendimentos</h3>
            <p id="historyPatientInfo"></p>
            <div id="historyList" class="history-list"></div>
            <button class="modal-btn cancel-btn" onclick="closeModal('patientHistoryModal')" aria-label="Fechar hist√≥rico" role="button">Fechar</button>
        </div>
    </div>
    <!-- Discount Modal -->
    <div id="discountModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="discountTitle">
        <div class="modal-content">
            <span class="close" onclick="closeModal('discountModal')" aria-label="Fechar modal de desconto">&times;</span>
            <h3 id="discountTitle">Adicionar Desconto</h3>
            <div id="serviceInfo" class="service-info" style="display: none;">
                <h4 id="serviceNameDisplay"></h4>
                <p>Pre√ßo Atual: <span id="currentPriceDisplay" class="price-display">R$ 0,00</span></p>
                <p id="discountedInfo" style="display: none;">
                    Pre√ßo com Desconto: <span id="discountedPriceDisplay" class="final-price-display">R$ 0,00</span>
                </p>
            </div>
            <div class="discount-checkbox-group">
                <div class="discount-checkbox-item">
                    <input type="checkbox" id="industryDiscount" onchange="toggleDiscountInput('industryDiscountInput', this.checked); calculateDiscount()">
                    <label for="industryDiscount">Desconto Industria</label>
                    <div class="discount-input-group" id="industryDiscountInput" style="display: none;">
                        <input type="number" id="industryDiscountValue" placeholder="10.00" step="0.01" min="0" max="100" onchange="calculateDiscount()">
                        <span>%</span>
                    </div>
                    <small>Digite um valor em %</small>
                </div>
                <div class="discount-checkbox-item">
                    <input type="checkbox" id="promotionalDiscount" onchange="toggleDiscountInput('promotionalDiscountInput', this.checked); calculateDiscount()">
                    <label for="promotionalDiscount">Desconto Promocional</label>
                    <div class="discount-input-group" id="promotionalDiscountInput" style="display: none;">
                        <input type="number" id="promotionalDiscountValue" placeholder="0.00" step="0.01" min="0" max="100" onchange="calculateDiscount()">
                        <span>%</span>
                    </div>
                    <small>Digite um valor em %</small>
                </div>
            </div>
            <div class="promotion-select-group">
                <div>
                    <label for="promotionType">Sele√ß√£o de promo√ß√£o</label>
                    <select id="promotionType">
                        <option value="">Selecione</option>
                        <option value="Semana do Consumidor">Semana do Consumidor</option>
                        <option value="Black Friday">Black Friday</option>
                        <option value="Outros">Outros</option>
                    </select>
                </div>
                <div>
                    <label for="startDate">Data de In√≠cio</label>
                    <input type="date" id="startDate">
                </div>
                <div>
                    <label for="endDate">Data de T√©rmino</label>
                    <input type="date" id="endDate">
                </div>
                <div>
                    <label for="otherPromotion">Outra promo√ß√£o</label>
                    <input type="text" id="otherPromotion" placeholder="Digite o nome da promo√ß√£o" style="display: none;">
                </div>
            </div>
            <button class="apply-discount-btn" onclick="applyDiscount()">Aplicar Desconto</button>
        </div>
    </div>
    <!-- Declaration Time Modal -->
    <div id="declarationTimeModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="declarationTimeTitle">
        <div class="modal-content">
            <span class="close" onclick="closeModal('declarationTimeModal')" aria-label="Fechar modal de hor√°rio de declara√ß√£o">&times;</span>
            <h3 id="declarationTimeTitle">Adicionar Hor√°rio de Entrada</h3>
            <p id="declarationPatientInfo"></p>
            <label for="entryTime">Hor√°rio de Entrada do Trabalhador <span aria-hidden="true" class="required">*</span></label>
            <input type="time" id="entryTime" required aria-required="true" aria-describedby="entryTimeDesc">
            <small id="entryTimeDesc" class="sr-only">Selecione o hor√°rio de entrada do trabalhador para incluir na declara√ß√£o.</small>
            <button class="modal-btn" onclick="confirmDeclarationTime()" aria-label="Gerar declara√ß√£o" role="button">Gerar Declara√ß√£o</button>
            <button class="modal-btn cancel-btn" onclick="closeModal('declarationTimeModal')" aria-label="Cancelar" role="button">Cancelar</button>
        </div>
    </div>

    <!-- Modal de Motivo (Nova Adi√ß√£o) -->
<div id="reasonModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="reasonTitle">
    <div class="modal-content">
        <span class="close" onclick="closeModal('reasonModal')" aria-label="Fechar modal de motivo">&times;</span>
        <h3 id="reasonTitle">Motivo da Inativa√ß√£o</h3>
        <p id="reasonDescription">Informe o motivo da inativa√ß√£o:</p>
        <label for="reasonInput">Motivo <span aria-hidden="true" class="required">*</span></label>
        <textarea id="reasonInput" placeholder="Digite o motivo detalhado (ex: Paciente cancelou por motivos pessoais)..." aria-required="true" required rows="4"></textarea>
        <small id="reasonInputDesc" class="sr-only">Campo obrigat√≥rio. Forne√ßa um motivo claro para auditoria.</small>
        <button class="modal-btn" onclick="confirmReason()" aria-label="Confirmar motivo e atualizar status" role="button">Confirmar</button>
        <button class="modal-btn cancel-btn" onclick="closeModal('reasonModal')" aria-label="Cancelar" role="button">Cancelar</button>
    </div>
</div>

</body>
</html>